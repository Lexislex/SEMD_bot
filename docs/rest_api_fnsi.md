# REST API Федерального реестра НСИ

## GET /searchDictionary

Получение перечня справочников НСИ.

### Параметры запроса

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |
| identifier | Строка | Нет | ID справочника |
| page | Строка | Нет | Номер страницы (по умолчанию 1) |
| size | Строка | Нет | Элементов на странице (по умолчанию 200) |
| sorting | Строка | Нет | Сортировка: mnemonic, fullName, firstPublishDate, currentPublishDate, shortName, groupName, typeName, respOrganizationName |
| sortingDirection | Строка | Нет | ASC / DESC |
| showArchive | Булевое | Нет | Поиск по архивным версиям |
| publishDateFrom | Строка | Нет | Дата от (yyyy-MM-dd HH:mm:ss) |
| publishDateTo | Строка | Нет | Дата до (yyyy-MM-dd HH:mm:ss) |
| name | Строка | Нет | Название справочника |
| description | Строка | Нет | Описание |
| law | Число | Нет | ID НПА (OID 1.2.643.5.1.13.13.99.2.533) |
| respOrganizationId | Число | Нет | ID ответственной организации |
| typeId | Число | Нет | ID типа справочника |
| groupId | Число | Нет | ID группы |

### Поля ответа (List)

| Поле | Тип | Описание |
|------|-----|----------|
| oid | Строка | Код справочника (TYPE_PRIMARY) |
| identifier | Строка | Идентификатор |
| version | Строка | Версия |
| fullName | Строка | Полное наименование |
| shortName | Строка | Краткое название |
| description | Строка | Аннотация |
| rowsCount | Число | Количество записей |
| createDate | Строка | Дата создания |
| publishDate | Строка | Дата публикации |
| lastUpdate | Строка | Дата изменения |
| approveDate | Строка | Дата подтверждения актуальности |
| archive | Булевое | Признак архивной версии |
| hierarchical | Булевое | Иерархический справочник |
| codes | Массив | type (TYPE_PRIMARY/TYPE_OTHER/TYPE_PLAIN) + value |
| fields | Массив | field, dataType (VARCHAR/DATETIME/INTEGER), alias, description |
| keys | Массив | Ключи справочника |
| laws | Массив | id + version НПА |
| groupId | Число | ID группы |
| typeId | Число | ID типа |
| respOrganizationId | Число | ID ответственной организации |
| authOrganizationId | Число | ID уполномоченной организации |
| nsiDictionaryId | Число | Внутренний ID |

### Пример

```bash
curl -X GET "https://nsi.rosminzdrav.ru/port/rest/searchDictionary?userKey=API_KEY&identifier=1.2.643.5.1.13.13.99.2.533&page=1&size=2"
```

---

## GET /passport

Получение паспорта и структуры справочника.

### Параметры запроса

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |
| identifier | Строка | Да | ID справочника |
| version | Строка | Нет | Версия (по умолчанию текущая) |

### Поля ответа

Аналогично /searchDictionary, но для одного справочника.

---

## GET /data

Получение данных справочника.

### Параметры запроса

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |
| identifier | Строка | Да | ID справочника |
| version | Строка | Нет | Версия (по умолчанию текущая) |
| page | Число | Нет | Номер страницы |
| size | Число | Нет | Элементов на странице |
| columns | Массив | Нет | Столбцы для отображения |
| sorting | Строка | Нет | Столбец сортировки |
| sortingDirection | Строка | Нет | ASC / DESC |
| filters | Массив | Нет | Условия отбора (объединяются по И) |

### Поля ответа (List)

| Поле | Тип | Описание |
|------|-----|----------|
| column | Строка | Наименование столбца |
| value | - | Значение |

### Тип данных: коллекция

Элементы разделяются `;`, заключаются в `\"`:
```json
{"column": "COLLECT_1", "value": "\"val1\";\"val2\";\"val3\""}
```

---

## GET /versions

Получение списка версий справочника.

### Параметры запроса

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |
| identifier | Строка | Да | ID справочника |
| page | Число | Нет | Номер страницы |
| size | Число | Нет | Элементов на странице |

### Поля ответа

| Поле | Тип | Описание |
|------|-----|----------|
| version | Строка | Версия |
| createDate | Строка | Дата создания |
| publishDate | Строка | Дата публикации |
| lastUpdate | Строка | Дата изменения |
| releaseNotes | Строка | Описание изменений |
| archive | Булевое | Признак архивной версии |

---

## GET /tree

Получение структуры иерархического справочника (один уровень дочерних записей).

### Параметры запроса

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |
| identifier | Строка | Да | ID справочника |
| version | Строка | Нет | Версия |
| value | Строка | Нет | Ключ родительского элемента |

### Поля ответа

| Поле | Тип | Описание |
|------|-----|----------|
| id | Число | ID записи |
| parentId | Число | ID родителя |
| value | Строка | Отображаемое значение |
| hasChildren | Булевое | Есть дочерние записи |

---

## GET /compare

Сравнение двух версий справочника.

### Параметры запроса

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |
| identifier | Строка | Да | ID справочника |
| date1 | Строка | Да | Начальная дата (ГГГГ-ММ-ДД ЧЧ:ММ) |
| date2 | Строка | Нет | Конечная дата (по умолчанию текущая) |
| page | Число | Нет | Номер страницы |
| size | Число | Нет | Элементов на странице |

### Поля ответа

| Поле | Тип | Описание |
|------|-----|----------|
| total | Число | Количество изменений |
| list | Массив | Данные с полем operation |

**operation**: DELETE, INSERT, UPDATE, ALTER_ADD_COLUMN, ALTER_DROP_COLUMN, ALTER_COLUMN, ALTER_ADD_KEY, ALTER_DROP_KEY

---

## GET /groups

Получение списка групп справочников.

### Параметры

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |

### Ответ

| Поле | Тип | Описание |
|------|-----|----------|
| id | Число | ID группы |
| name | Строка | Наименование |

---

## GET /types

Получение списка типов справочников.

### Параметры

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |

### Ответ

| Поле | Тип | Описание |
|------|-----|----------|
| id | Число | ID типа |
| name | Строка | Наименование |

---

## GET /responsibleOrganizations

Получение списка ответственных организаций.

### Параметры

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |

### Ответ

| Поле | Тип | Описание |
|------|-----|----------|
| id | Число | ID организации |
| name | Строка | Наименование |

---

## GET /authOrganizations

Получение списка уполномоченных организаций.

### Параметры

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |

### Ответ

| Поле | Тип | Описание |
|------|-----|----------|
| id | Число | ID организации |
| name | Строка | Наименование |

---

## POST /validate

Проверка целостности данных на определённую дату.

### Параметры запроса (JSON body)

| Поле | Тип | Обяз. | Описание |
|------|-----|-------|----------|
| userKey | Строка | Да | Маркер безопасности |
| date | Строка | Нет | Дата проверки |
| checkData | Массив | Нет | identifier + records [{id}] |

### Поля ответа

| Поле | Тип | Описание |
|------|-----|----------|
| identifier | Строка | ID справочника |
| records | Массив | Проверяемые записи |
| result | Строка | VALID / NOT_VALID |

---

## Сервис оперативного доступа (snake_case)

Альтернативный API с параметрами в snake_case:

| camelCase | snake_case |
|-----------|------------|
| userKey | user_key |
| sortingDirection | sorting_direction |
| showArchive | show_archive |
| publishDateFrom | publish_date_from |
| publishDateTo | publish_date_to |
| respOrganizationId | resp_organization_id |
| typeId | type_id |
| groupId | group_id |

---

## Коды ошибок

| Код | Описание |
|-----|----------|
| 400 | Некорректные параметры запроса |
| 403 | Ошибка авторизации |
| 01x0009 | Неверный формат даты (ожидается yyyy-MM-dd HH:mm:ss) |
| 03x0001 | Справочник не найден |
| 03x0006 | Версия не существует |
| 04x0001 | Доступ запрещён |
